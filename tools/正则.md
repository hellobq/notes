# 正则

## 正则作用：

一种匹配模式，用来匹配字符或者位置。[正则图形化工具](https://regexper.com/)

## 创建正则
- 字面量：/pattern/[修饰符] eg: /love pattern/gi
- 构造函数：new RegExp(正则字符串[, 修饰符字符串]) eg: new RegExp('pattern', 'gi')

尽量使用字面量形式，因为构造函数中的正则是字符串作为参数，需要考虑字符转义问题，可能会多写 '/'。

**注意**：即使两者匹配的结果相同，但两者也不相等。因为存放对象的内存地址不同。

## 元字符

用来辅助正则匹配文本的特殊代码。

- \d 匹配数字    \D 匹配非数字
- \w 匹配字母、数字、下划线   \W 匹配除了字母数字下划线
- \s 匹配空格、tab、换行符   \S 匹配除了空格、tab、换行符
- . 匹配除\n之外的任意字符

## 边界
- \b 匹配独立部分（未和字母、数字、下划线连接的部分） \B 非独立部分
- ^ 匹配字符串的开始 
- $ 匹配字符串的结束（用在字符串首尾才有这个意思）

## 转义字符

在正则中本身就含有意义的字符，为了匹配字符串中的它们，所以需要在正则中转义。

需要转义的字符有: . * ? + ^ $ \ / - [ ] ( ) { } 

## 常用标识

对应着正则对象的可读属性：ignoreCase、global、multiline

- i 不区分大小写 
- g 全局匹配
- m 允许在使用^/$边界符时，.可匹配多行。（如果没有^/$，.默认是可以匹配多行的）

    ``` js
    `
    asa
    a
    `.match(/^a.+/g)  => null


    `
    asa
    a
    `.match(/^a.+/gm) => ['asa']
    ```

## 量词/横向模糊匹配(匹配字符串的长度是不固定的)
- ? 0或1个
- \+ 1个或多个
- \* 0个或多个
- {n, m}      至少n个最多m个
- {n}      匹配n个

## 范围词/字符集/纵向模糊匹配(可以匹配一个字符，但是这个字符是不确定的)

使用[]规定匹配的字符范围

**注意**：
- 如果匹配的是有意义的字符，则需要转义。
  ``` js
  /* 匹配0-9或者[] */

  const str = '9[kd[89]'
  str.match(/[[]\d]/g)   // ["9", "[", "[", "8", "9", "]"]

  ```

- 在[]内的^具有"除了"的意思。
  ``` js
  // 匹配除了0-9和[]的字符

  const str = '9[kd[89]'
  str.match(/[^\[\]\d]/g)   // ["k", "d"]

  ```

## 子集/分组

使多个字符作为一个整体来匹配。一个表达式中可以有多个子集。同时可用 `$1、$2、$3...` 拿到各个分组的内容。

``` js
// 固定字符的子集
const str1 = 'adcghabc0'
str1.match(/(abc)+/g)   // ["abc"]

// 固定字符的子集
const str = '9[kd[89]'
str.match(/([\d[]])+/g)  // ["9[", "[89]"]

```

## 或者/多选分支: |

匹配多种情况，和[]有相似之处。也可配合子集使用，功能也十分强大。

``` js
const str = '9[kd[89]'
str.match(/k|9/g)    str.match(/[k9]/g)  // ["9", "k", "9"]
```

## 贪婪匹配

在整个表达式得到匹配的前提下，会尽可能多的匹配

``` js
const str = 'aabab'
str.match(/a.*b/g)  // ['aabab']
```

## 懒惰匹配

在整个表达式得到匹配的前提下，尽量少匹配。实现的方式就是在贪婪匹配的量词后加 ?

``` js
str.match(/a.*?b/)   // ['aab', 'ab']

```

## 断言

为正则匹配提供条件，当断言为真时，才会去匹配。用于查找在某些内容之前或之后的文本。

- (?=pattern) 查找目标文本后面的字符要符合pattern模式
- (?!=pattern) 查找目标文本后面的字符不能符合pattern模式
- (?<=pattern) 查找目标文本前面的字符要符合pattern模式
- (?<!pattern) 查找目标文本前面的字符不能符合pattern模式

## 实用正则

提取图片src：

``` js
const str = 
  `<img src="/static/1.jpg" alt=""/> 
    <div>
        <img src="/static/14.jpg" alt=""/>
    </div>`;

console.log(
  str.match(/(?<==")[^"]+/g)
);

// ["/static/1.jpg", "/static/14.jpg"]
```

获取 url 中的参数及其值：

``` js
let url = 'https://www.baidu.com?name=jawil&age=23';

url.replace(/(\w+)=(\w+)/g, (str, k, v) => {
  console.log(k, v);
});

```

数字化格式：

``` js
let str = '1234567890';

console.log(
  str.replace(/\B(?=(\d{3})+(?!\d))/g, ',')
)

// 1,234,567,890
```

去掉字符串两端的空格（也可以实用兼容到 IE9+ 的 `trim()` 方法）：

``` js
let str = ' js de_j9s d  ';

console.log(
  str.replace(/^\s*|\s*$/g, '')
);

// js de_j9s d
```
